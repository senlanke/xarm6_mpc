<mujoco model="xarm6">
  <compiler angle="radian" meshdir="assets/"/>

  <option integrator="implicitfast"/>  <!-- 仿真选项：使用implicitfast积分器 -->

  <default>  <!-- 默认属性定义部分 -->
    <default class="xarm6">  <!-- 定义xarm7类的默认属性 -->
      <geom type="mesh" material="white"/>  <!-- 几何体类型为网格，使用白色材质 -->
      <joint axis="0 0 1" armature="0.1" range="-6.28319 6.28319" frictionloss="1"/>  <!-- 关节属性：Z轴旋转，转子惯性0.1，旋转范围±2π，摩擦损失1 在下面没有定义的时候就用默认的-->
      <general biastype="affine" ctrlrange="-6.28319 6.28319"/>  <!-- 通用驱动器：仿射偏置类型，控制范围±2π -->
      <default class="size1">  <!-- 定义size1子类默认属性 -->
        <joint damping="10"/>  <!-- 关节阻尼为10 -->
        <general gainprm="1500" biasprm="0 -1500 -150" forcerange="-50 50"/>  <!-- 通用驱动器参数：增益1500，偏置参数0 -1500 -150，力范围±50 -->
      </default>
      <default class="size2">  <!-- 定义size2子类默认属性 -->
        <joint damping="5"/>  <!-- 关节阻尼为5 -->
        <general gainprm="1000" biasprm="0 -1000 -100" forcerange="-30 30"/>  <!-- 通用驱动器参数：增益1000，偏置参数0 -1000 -100，力范围±30 -->
      </default>
      <default class="size3">  <!-- 定义size3子类默认属性 -->
        <joint damping="2"/>  <!-- 关节阻尼为2 -->
        <general gainprm="800" biasprm="0 -800 -80" forcerange="-20 20"/>  <!-- 通用驱动器参数：增益800，偏置参数0 -800 -80，力范围±20 -->
      </default>
      <site size="0.001" rgba="1 0 0 1" group="4"/>  <!-- 空间点属性：尺寸0.001，红色，组别4 -->
    </default>
  </default>


  <asset>
    <mesh name="base" file="base.stl"/>
    <mesh name="base_vhacd" file="base_vhacd.obj"/>
    <mesh name="link1" file="link1.stl"/>
    <mesh name="link1_vhacd" file="link1_vhacd.obj"/>
    <mesh name="link2" file="link2.stl"/>
    <mesh name="link2_vhacd" file="link2_vhacd.obj"/>
    <mesh name="link3" file="link3.stl"/>
    <mesh name="link3_vhacd" file="link3_vhacd.obj"/>
    <mesh name="link4" file="link4.stl"/>
    <mesh name="link4_vhacd" file="link4_vhacd.obj"/>
    <mesh name="link5" file="link5.stl"/>
    <mesh name="link5_vhacd" file="link5_vhacd.obj"/>
    <mesh name="link6" file="link6.stl"/>
    <mesh name="link6_vhacd" file="link6_vhacd.obj"/>
    <mesh name="gripper" file="NewEGripper.STL"/>

    <material name="white" rgba="1 1 1 1"/>
    <material name="gray" rgba="0.753 0.753 0.753 1"/>
  </asset>

  <worldbody>
    <body name="link_base" pos="0 0 0" >
      <inertial pos="0 0 0" 
          quat="0.998963 0 0 0.045497" 
          mass="2.7" 
          diaginertia="0.01 0.01 0.01"/>
      <geom name="link_base_visual" type="mesh" contype="0" conaffinity="0" group="1" density="0" mesh="base"/>
      <geom name="link_base_collision" type="mesh" mesh="base_vhacd"/>
      <body name="link1" pos="0 0 0.267">
        <inertial pos="-0.002 0.02692 -0.01332" quat="0.983139 0.180751 -0.00455228 0.0272976" mass="2.16" diaginertia="0.00539487 0.00519906 0.00281397"/>
        <joint name="joint1"  pos="0 0 0" axis="0 0 1" range="-6.28319 6.28319" actuatorfrcrange="-50 50" damping="1" frictionloss="1"/>
        <geom name="link1_visual" type="mesh" contype="0" conaffinity="0" group="1" density="0" mesh="link1"/>
        <geom name="link1_collision" type="mesh" mesh="link1_vhacd"/>
        <body name="link2" quat="0.707105 -0.707108 0 0">
          <inertial pos="0.03531 -0.21398 0.03386" quat="0.71118 0.614686 0.139936 -0.311132" mass="1.71" diaginertia="0.017867 0.017867 0.017867"/>
          <joint name="joint2" pos="0 0 0" axis="0 0 1" range="-2.059 2.0944" actuatorfrcrange="-50 50" damping="1" frictionloss="1"/>
          <geom name="link2_visual" type="mesh" contype="0" conaffinity="0" group="1" density="0" mesh="link2"/>
          <geom name="link2_collision" type="mesh" mesh="link2_vhacd"/>
          <body name="link3" pos="0.0535 -0.2845 0">
            <inertial pos="0.06781 0.10749 0.01457" quat="0.119516 0.409082 -0.734824 0.527638" mass="1.384" diaginertia="0.004543 0.004543 0.004543"/>
            <joint name="joint3" pos="0 0 0" axis="0 0 1" range="-3.927 0.19198" actuatorfrcrange="-32 32" damping="1" frictionloss="1"/>
            <geom name="link3_visual" type="mesh" contype="0" conaffinity="0" group="1" density="0" mesh="link3"/>
            <geom name="link3_collision" type="mesh" mesh="link3_vhacd"/>
            <body name="link4" pos="0.0775 0.3425 0" quat="0.707105 -0.707108 0 0">
              <inertial pos="-0.00021 0.02578 -0.02538" quat="0.994019 0.0752563 -0.00686804 0.0788347" mass="1.115" diaginertia="0.00440091 0.00406855 0.00103407"/>
              <joint name="joint4" pos="0 0 0" axis="0 0 1" range="-6.28319 6.28319" actuatorfrcrange="-32 32" damping="1" frictionloss="1"/>
              <geom name="link4_visual" type="mesh" contype="0" conaffinity="0" group="1" density="0" mesh="link4"/>
              <geom name="link4_collision" type="mesh" mesh="link4_vhacd"/>
              <body name="link5" quat="0.707105 0.707108 0 0">
                <inertial pos="0.05428 0.01781 0.00543" quat="-0.0766302 0.578118 -0.269638 0.766291" mass="1.275" diaginertia="0.00289757 0.0023276 0.000951789"/>
                <joint name="joint5" pos="0 0 0" axis="0 0 1" range="-1.69297 3.14159" actuatorfrcrange="-32 32" damping="1" frictionloss="1"/>
                <geom name="link5_visual" type="mesh" contype="0" conaffinity="0" group="1" density="0" mesh="link5"/>
                <geom name="link5_collision" type="mesh" mesh="link5_vhacd"/>
                <body name="link6" pos="0.076 0.097 0" quat="0.707105 -0.707108 0 0">
                  <inertial pos="0 0.00064 -0.00952" quat="0 0.707107 0 0.707107" mass="0.1096" diaginertia="7.9715e-05 4.8111e-05 4.5293e-05"/>
                  <joint name="joint6" pos="0 0 0" axis="0 0 1" range="-6.28319 6.28319" actuatorfrcrange="-20 20" damping="1" frictionloss="1"/>
                  <geom name="link6_visual" type="mesh" contype="0" conaffinity="0" group="1" density="0" material="gray" mesh="link6"/>
                  <geom name="link6_collision" type="mesh" material="gray" mesh="link6_vhacd"/>
                  <body name="gripper" pos="-0.07 0 -0.003" quat="1 0 0 0"> 
                    <!-- <inertial pos="0 0 0" quat="1 0 0 0" mass="0" diaginertia="0.0001 0.0001 0.0001"/> -->
                    <geom name="gripper_visual" type="mesh" contype="0" conaffinity="0" group="1" density="0" material="gray" mesh="gripper"/>
                    <geom name="gripper_collision" type="mesh" density="0" material="gray" mesh="gripper"/>
                  </body>
                <site name="ee_site" pos="0 0 0.1" />
              </body>
            </body>
          </body>
        </body>
      </body>
      </body>
      <site name="base_link_site" pos="0 0 0" quat="1 0 0 0" />
    </body>
  </worldbody>
  <!-- motor型执行器：直接施加力矩/力，没有内置控制回路。
  使用此类执行器时，用户需要自行计算并施加控制力矩来维持机械臂姿态，否则会因重力作用而下坠。 -->
  <!-- <actuator> 
    <motor name="joint1_motor" joint="joint1" gear="1"/>
    <motor name="joint2_motor" joint="joint2" gear="1"/>
    <motor name="joint3_motor" joint="joint3" gear="1"/>
    <motor name="joint4_motor" joint="joint4" gear="1"/>
    <motor name="joint5_motor" joint="joint5" gear="1"/>
    <motor name="joint6_motor" joint="joint6" gear="1"/>
  </actuator> -->

  <actuator>  <!-- 力矩执行器定义：ctrl 直接作为关节力矩输入 -->
    <motor name="act1" joint="joint1" gear="1" forcelimited="true" forcerange="-50 50"/>
    <motor name="act2" joint="joint2" gear="1" forcelimited="true" forcerange="-50 50"/>
    <motor name="act3" joint="joint3" gear="1" forcelimited="true" forcerange="-30 30"/>
    <motor name="act4" joint="joint4" gear="1" forcelimited="true" forcerange="-30 30"/>
    <motor name="act5" joint="joint5" gear="1" forcelimited="true" forcerange="-20 20"/>
    <motor name="act6" joint="joint6" gear="1" forcelimited="true" forcerange="-20 20"/>
  </actuator>

  <!-- <actuator> 
    <position name="joint1_position" joint="joint1" kp="1000" kv="100" ctrlrange="-6.28319 6.28319"/>
    <position name="joint2_position" joint="joint2" kp="1000" kv="100" ctrlrange="-2.059 2.0944"/>
    <position name="joint3_position" joint="joint3" kp="1000" kv="100" ctrlrange="-3.927 0.19198"/>
    <position name="joint4_position" joint="joint4" kp="1000" kv="100" ctrlrange="-6.28319 6.28319"/>
    <position name="joint5_position" joint="joint5" kp="1000" kv="100" ctrlrange="-1.69297 3.14159"/>
    <position name="joint6_position" joint="joint6" kp="1000" kv="100" ctrlrange="-6.28319 6.28319"/>
  </actuator> -->

  <contact>
    <exclude body1="link_base" body2="link1" />
    <exclude body1="link1" body2="link2" />
    <exclude body1="link2" body2="link3" />
    <exclude body1="link3" body2="link4" />
    <exclude body1="link4" body2="link5" />
    <exclude body1="link5" body2="link6" />
    <exclude body1="link6" body2="gripper" />
  </contact>
  
  <!-- <option gravity="0 0 0"/> -->

  <keyframe>
    <key name="home" qpos="0.100001 -0.567064 -0.539810 0.107489 0.404987 0.090729" />
  </keyframe>

  <sensor>
    <framepos name="base_link_site_pos" objtype="site" objname="base_link_site" />
    <framequat name="base_link_site_quat" objtype="site" objname="base_link_site" />
    <framelinvel name="base_link_site_linvel" objtype="site" objname="base_link_site" />
    <frameangvel name="base_link_site_angvel" objtype="site" objname="base_link_site" />
    <velocimeter name="base_link_site_vel" site="base_link_site" />
    <!-- 为末端执行器添加传感器 -->
    <framepos name="ee_site_pos" objtype="site" objname="ee_site" />
    <framelinvel name="ee_site_linvel" objtype="site" objname="ee_site" />
    <frameangvel name="ee_site_angvel" objtype="site" objname="ee_site" />
    <velocimeter name="ee_site_vel" site="ee_site" />
  </sensor>

  <statistic center="0.2 0 0.4" extent=".65"/>

  <visual>
    <headlight diffuse="0.6 0.6 0.6" ambient="0.3 0.3 0.3" specular="0 0 0"/>
    <rgba haze="0.15 0.25 0.35 1"/>
    <global azimuth="150" elevation="-20"/>
  </visual>

  <asset>
    <texture type="skybox" builtin="gradient" rgb1="0.3 0.5 0.7" rgb2="0 0 0" width="512" height="3072"/>
    <texture type="2d" name="groundplane" builtin="checker" mark="edge" rgb1="0.2 0.3 0.4" rgb2="0.1 0.2 0.3"
      markrgb="0.8 0.8 0.8" width="300" height="300"/>
    <material name="groundplane" texture="groundplane" texuniform="true" texrepeat="5 5" reflectance="0.2"/>
  </asset>

  <worldbody>
    <light pos="0 0 1.5" dir="0 0 -1" directional="true"/>
    <geom name="floor" size="0 0 0.05" type="plane" material="groundplane"/>
  </worldbody>

</mujoco>
